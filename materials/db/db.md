# Базы данных

## 1 Что такое база данных?

**База данных** - это упорядоченный набор структурированной информации или данных, которые обычно хранятся в электронном виде в компьютерной системе. 

База данных обычно управляется системой управления базами данных (СУБД). Данные вместе с СУБД, а также приложения, которые с ними связаны, называются системой баз данных или просто базой данных.

Система управления базами данных (СУБД) - это совокупность языковых и программных средств, которая осуществляет доступ к данным, позволяет их создавать, менять и удалять, обеспечивает безопасность данных и т.д.

Данные в наиболее распространенных типах современных баз данных обычно хранятся в виде строк и столбцов формирующих таблицу. Этими данными можно легко управлять, изменять, обновлять, контролировать и упорядочивать. В большинстве баз данных для записи и запросов данных используется язык структурированных запросов (SQL).

**Сервер баз данных** - это сервер, который выполняет обслуживание и управление базой данных и отвечает за целостность и сохранность данных, а также обеспечивает операции ввода-вывода при доступе клиента к информации.

Доступ к базе данных от прикладной программы или пользователя производится путем обращения к клиентской части системы. В качестве основного интерфейса между клиентской и серверной частями выступает SQL.

## 2 Типы баз данных

1. **Реляционные базы данных (RDBMS):** Тип БД, основанный на реляционной модели данных, предложенной Эдгаром Коддом. Данные организованы в виде таблиц, состоящих из строк и столбцов, а доступ к данным осуществляется с использованием языка структурированных запросов (SQL). **Примеры:** MySQL, PostgreSQL, Oracle Database, Microsoft SQL Server.
2. **NoSQL (Not Only SQL) базы данных:**  Это семейство баз данных, которые не используют реляционную модель данных и SQL для доступа к данным. Они разработаны для хранения и обработки больших объемов неструктурированных данных и обеспечивают гибкость и масштабируемость. **Примеры:** MongoDB, Cassandra, Redis, Couchbase.
3. **Объектно-ориентированные базы данных:** Этот тип баз данных предназначен для хранения объектов программирования, таких как классы и объекты. Он предоставляет средства для сохранения, извлечения и манипулирования объектами и их свойствами. **Примеры:** db4o, ObjectDB, ZODB.
4. **Колоночные базы данных:** Это базы данных, которые организуют данные в виде колонок, а не строк, что обеспечивает эффективное хранение и анализ больших объемов данных, особенно для аналитики и OLAP (Online Analytical Processing). **Примеры:** Google Bigtable, Apache Cassandra, Vertica.
5. **Временные базы данных:** Этот тип баз данных предназначен для хранения временных данных, таких как данные датчиков, журналы событий или аудита. Он обеспечивает поддержку временных операций и запросов. **Примеры:** InfluxDB, TimescaleDB, Oracle Temporal Database.
6. **Графовые базы данных:** Графовые базы данных предназначены для хранения и обработки данных в виде графов. Они обеспечивают эффективное представление и анализ связей и отношений между данными. **Примеры:** Neo4j, Amazon Neptune, ArangoDB.

### 2.1 Реляционные базы данных

**Реляционная БД** - это БД, в основе построения которой лежит реляционная модель. В такой базе данные структурированы в виде таблиц, которые содержат строки и столбцы.

Данные в реляционных структурах организованы в виде набора таблиц, называемых отношениями, состоящих из столбцов и строк. Каждая строка таблицы представляет собой набор связанных значений, относящихся к одному объекту или сущности. Каждая строка в таблице может быть помечена уникальным идентификатором, называемым первичным ключом, а строки из нескольких таблиц могут быть связаны с помощью внешних ключей.

**ТЕРМИНОЛОГИЯ**

- Отношение: (таблица) Структура данных целиком, набор записей.
- Кортеж: (запись) Каждая строка, содержащая данные.
- Мощность: Число кортежей в таблице.
- Атрибут: (поле) Столбец в таблице.
- Размерность: Число атрибутов в таблице.
- Домен атрибута: Допустмые неповторяющиеся значения, которые можно занести в поле.

**ОСНОВНЫЕ ПРИНЦИПЫ РЕЛЯЦИОННЫХ БД**

- Все данные на концептуальном уровне представляются в виде объектов, заданных в виде строк и столбцов, называемых отношением, более распространенное название - таблица.
- Все операции выполняются над целыми отношениями и результатом этих операций является отношение.
- Модель данных в реляционных БД определена заранее и является строго типизированной.
- На пересечении каждого столбца и строчки допускается только одно значение.
- Каждый столбец проименован и имеет определённый тип, которому следуют значения со всех строк в данном столбце.
- Столбцы располагаются в определённом порядке, который определяется при создании таблицы.
- В таблице может не быть ни одной строчки, но обязательно должен быть хотя бы один столбец.
- Запросы к БД возвращают результат в виде таблиц.
- Отношения между таблицами устанавливаются с помощью ключей, что обеспечивает целостность данных.

Любая СУБД имеет встроенную систему целостности и непротиворечивости данных. Эта система работает на наборе правил, определённых в схеме базы данных. Первичный ключ и внешние ключи как раз являются одними из таких правил.

**ПЕРВИЧНЫЙ КЛЮЧ**

**Ключевое поле (первичный ключ)** - это поле (или набор полей), значение которого однозначно определяет запись в таблице. Наличие первичного ключа не обязательно, а целостность данных может определяться, к примеру, на уровне приложения.

**ВНЕШНИЙ КЛЮЧ**

- **Внешний ключ** - это поле (или набор полей) в одной таблице, которое ссылается на первичный ключ в другой таблице. 
- Таблица с внешним ключом называется дочерней таблицей, а таблица с первичным ключом называется ссылочной или родительской таблицей. 
- Правило внешнего ключа гарантирует, что при создании записей в дочерней таблице, значение поля, являющегося внешним ключом, есть в родительской таблице.
- Наличие внешнего ключа - это такое же необязательное требование, как и в случае с первичным ключом.
- Если внешний ключ не определён, то всё также будет работать, но СУБД не будет проверять, что, например, при создании записи в таблице Purchase в полях buyer_id и good_id лежат значения, которые определены в соответствующих таблицах в поле id.

### 2.2 NoSQL базы данных

NoSQL базы данных (Not Only SQL) - это базы данных, которые отличаются от реляционных моделей и обеспечивают гибкость в хранении и обработке данных. Эти базы данных стали популярными благодаря своей способности обрабатывать большие объемы неструктурированных данных и обеспечивать горизонтальное масштабирование.

Key-value базы данных - это тип баз данных, которые хранят данные как совокупность пар «ключ-значение», в которых ключ служит уникальным идентификатором.

Стандартная реализация не даёт никакого представления о том, что содержит фактическое значение - когда вы получаете значение с помощью ключа, у вас нет гарантии того, что вы получаете. Это означает, что вам придётся фильтровать или обрабатывать данные, которые вам не нужны, в коде вашего приложения. Как правило, это будет менее эффективно с точки зрения производительности по сравнению с выполнением большей части этой работы в базе данных.

Как ключи, так и значения могут представлять собой что угодно: от простых до сложных составных объектов.

- NoSQL базы данных не требуют строгой схемы данных, что позволяет хранить разнородные данные в одной базе данных
- Многие NoSQL базы данных способны горизонтально масштабироваться путем добавления новых серверов, что обеспечивает высокую производительность и доступность
- NoSQL базы данных могут быть документо-ориентированными, графовыми, столбцовыми и ключ-значение, что позволяет выбирать подходящую модель данных для конкретной задачи
- Можно хранить разнородные данные без необходимости предварительной определенной структуры
- Обеспечивает возможность обработки больших объемов данных путем добавления новых серверов
- Многие NoSQL базы данных оптимизированы для определенных типов запросов и обеспечивают высокую производительность

Документоориентированные базы данных - это тип баз данных, направленный на хранение и запрос данных в виде документов, подобном JSON.

В отличие от других баз данных, документоориентированные оперируют «документами», сгруппированными по коллекциям. Документ представляет собой набор атрибутов (ключ и соответствующее ему значение). Значения могут быть как и простыми типами данных (строки, числа или даты), так и более сложными, такими как вложенные объекты, массивы и ссылки на другие документы.

В документоориентированных БД отсутствует схема данных, что позволяет добавлять новую информацию в некоторые записи, не требуя при этом, чтобы все остальные записи в базе данных имели одинаковую структуру.

Документы в базе данных адресуются с помощью уникального ключа, обычно это строка, которая генерируется автоматически. По нему можно, например, извлекать запись или ссылаться на другие документы.

Другой значимой особенностью документоориентированных баз данных является то, что помимо простого поиска документов по ключу, как в key-value базах данных, они предоставляют свой язык запросов, функционал, синтаксис и производительность которого отличается от одной реализации к другой.

## 3 Этапы проектирования БД

**3.1 ФОРМУЛИРОВАНИЕ И АНАЛИЗ ТРЕБОВАНИЙ**

- На этом этапе устанавливаются цели организации, определяются требования к БД.

**3.2 ПРОЕКТИРОВАНИЕ**

- Определение обьектов и их характеристик, которые будут храниться в БД.
- В процессе логического проектирования высокоуровневое представление данных преобразуется в структуру используемой СУБД. Основной целью этапа является устранение избыточности данных с использованием специальных правил нормализации. На выходе получаем СУБД-ориентированную структуру базы данных и спецификации прикладных программ. На этом этапе часто моделируют базы данных применительно к различным СУБД и проводят сравнительный анализ моделей.

**3.3 СОЗДАНИЕ СХЕМЫ БД**

Этап создания схемы базы данных включает в себя определение сущностей и их атрибутов, выявление отношений между этими сущностями, нормализацию данных для минимизации избыточности, а также определение первичных и внешних ключей для обеспечения целостности данных. На основе этих данных создается структура базы данных, которая отражает требования приложения и обеспечивает эффективное хранение и доступ к данным. Этот процесс требует внимательного анализа данных и предварительного планирования, чтобы создать устойчивую и надежную базу данных для долгосрочного использования.

**3.4 ФИЗИЧЕСКОЕ ПРОЕКТИРОВАНИЕ**

На этапе физического проектирования определяется выбор конкретной базы данных, которая будет использоваться для реализации проекта. Затем определяются типы данных для каждого атрибута, а также индексы, которые будут использоваться для ускорения запросов. Далее проектируется структура таблиц, включая определение файловых групп и распределение данных между ними. На этом этапе также определяются параметры хранения данных, такие как размер страницы и кластеризация индексов. Наконец, проводится оптимизация физической структуры для обеспечения высокой производительности и эффективного использования ресурсов сервера. В результате этого этапа формируется физическая реализация базы данных, готовая к развертыванию и использованию в рабочей среде.

**3.5 ТЕСТИРОВАНИЕ И ПОДДЕРЖКА**

После создания и развертывания базы данных начинается этап тестирования и поддержки, который включает в себя следующие шаги. Сначала проводятся функциональные тесты, чтобы проверить правильность работы базы данных согласно спецификации требований. Это включает в себя проверку корректности выполнения запросов, обработку ошибок и соответствие требованиям безопасности. Затем проводятся тесты на производительность, чтобы оценить скорость работы базы данных и ее способность обрабатывать большие объемы данных и одновременных запросов. После завершения тестирования начинается этап поддержки, который включает в себя мониторинг работы базы данных и ее производительности, а также регулярное обновление и оптимизацию структуры базы данных в соответствии с изменяющимися требованиями и нагрузкой. Также в этот период важно обеспечивать резервное копирование данных и восстановление базы данных в случае сбоев или аварийных ситуаций. Этот этап продолжается на протяжении всего жизненного цикла базы данных, чтобы обеспечить ее надежную и эффективную работу в течение всего времени использования.

## 4 СУБД

**Система управления базой данных (СУБД)** - это специальный пакет программ, посредством которого реализуется централизованное управление базой данных и обеспечивается доступ к данным. В общем случае под СУБД можно понимать любой программный продукт, поддерживающий процессы создания, ведения и использования базы данных. К СУБД относятся следующие основные виды программ:

- полнофункциональные СУБД;
- серверы баз данных;
- клиенты баз данных;
- средства разработки программ работы с базой данных.

**Полнофункциональные** СУБД представляют собой традиционные СУБД.

Большинство современных СУБД являются полнофункциональными. К ним относятся такие пакеты, как ndBaseIV, Microsoft Access, Microsoft FoxPro, Paradox R:BASE. Обычно полнофункциональные СУБД имеют развитый интерфейс, позволяющий с помощью команд меню выполнять основные действия с базой данных: создавать и модифицировать структуры таблиц, вводить данные, формировать запросы, разрабатывать и выводить на печать отчеты.

Для создания запросов и отчетов не обязательно программирование, удобно пользоваться мастерами, а для создания запросов использовать язык QBE (Query By Example – создание запросов по образцу). Многие полнофункциональные СУБД включают средства программирования для профессиональных разработчиков. Некоторые системы имеют средства проектирования схем баз данных или CASE-подсистемы, а также средства доступа к другим базам данных и к данным SQL-серверов.

**Серверы баз данных** предназначены для организации центров обработки данных в сетях ЭВМ. Число таких СУБД,постоянно растет. Эффективность функционирования информационной системы во многом зависит от ее архитектуры. В настоящее время перспективной является архитектура клиент-сервер. Она предполагает наличие компьютерной сети и распределенной базы данных, включающей корпоративную базу данных (КБД) и персональные базы данных (ПБД). КБД размещается на компьютере-сервере, ПБД на компьютерах сотрудников подразделений, являющихся клиентами корпоративной базы данных.

**Сервером** определенного ресурса в компьютерной сети называется компьютер (программа), управляющий этим ресурсом, клиентом – компьютер (программа), использующий этот ресурс. В качестве ресурса компьютерной сети могут выступать базы данных, файловые системы, службы печати, почтовые службы. Тип сервера определяется видом ресурса, которым он управляет. Например, если управляемым ресурсом является база данных, то соответствующий сервер называется сервером базы данных. Преимущества организации информационной системы по архитектуре клиент-сервер является удачное сочетание централизованного хранения, обслуживания и коллективного доступа к общей корпоративной информации с индивидуальной работой пользователей над персональной информацией.

Примерами серверов баз данных являются следующие программы: Net Ware SQL (Novell), MS SQL Server (Microsoft), InterBase (Borland), SQLBase Server (Gupta), Intelligent Database (Ingress).

Клиентскими программами для серверов баз данных могут быть различные программы: полнофункциональные СУБД, электронные таблицы, текстовые процессоры, программы электронной почты и т.д. При этом элементы пары «клиент-сервер» могут принадлежать одному или разным производителям программного обеспечения.

Например, для сервера баз данных SQL Server (Microsoft) в роли клиентских программ могут выступать многие СУБД, такие как: MS Access, Visual FoxPro, dBaseIV, Blyth Software, Paradox, Focus и др. Средства разработки программ работы с базами данных могут использоваться для создания разновидностей следующих программ:

Серверы баз данных предназначены для организации центров обработки данных в сетях ЭВМ. Число таких СУБД постоянно растет.

- клиентских программ;
- серверов баз данных и их отдельных компонентов;
- пользовательских приложений.

Программы первого и второго видов довольно малочисленны, так как предназначены, главным образом, для системных программистов. Пакетов третьего вида гораздо больше, но меньше, чем полнофункциональных СУБД. К средствам разработки пользовательских приложений относятся системы программирования, разнообразные библиотеки программ для различных языков программирования, а также пакеты автоматизации разработок (в том числе систем типа клиент-сервер). В числе наиболее распространенных можно назвать следующие инструментальные системы: Delphi и Power Builder (Borland), Visual Basic (Microsoft), SILVERRUN (Computer Advisers Inc.), S-Designor (SDP и Powersofr) и Erwin(Logic Works). По характеру использования СУБД делятся на персональные и многопользовательские:

**Персональные СУБД** обычно обеспечивают возможность создания персональных баз данных и недорогих приложений, работающих с ними. Персональные СУБД или разработанные с их помощью приложения могут выступать в роли клиентской части многопользовательской СУБД. К персональным СУБД, например, относятся Visual FoxPro, Paradox, Clipper, dBase, Access и др.

**Многопользовательские СУБД** включают в себя сервер баз данных и клиентскую часть и, как правило, могут работать в неоднородной вычислительной среде (с разными типами ЭВМ и операционными системами). К многопользовательским СУБД относятся, например, СУБД Oracle и Informix.

**Популярные СУБД**

- Oracle
- MySQL
- Microsoft SQL Server
- PostgreSQL
- MongoDB
- Redis
- Snowflake
- ElasticSearch
- IBM Db2
- SQLite

**Описание различных СУБД**

**MySQL**

Одна из самых распространенных систем управления базами данных. Используется в ряде крупных мировых компаний (Meta, Twitter, Amazon, LinkedIn и т.д.). Это реляционная СУБД, относящаяся к свободному программному обеспечению.

Особенности:
- Возможность работы с различными типами таблиц, от популярных InnoDB или MyISAM до редко используемых MERGE или HEAP.
- Постоянное обновление и добавление новых поддерживаемых типов таблиц.
- Высокая скорость работы — MySQL считается одной из самых быстрых несмотря на то, что одновременно с ней могут работать несколько пользователей, а количество строк в таблицах достигает 50 миллионов.
- Простота — с MySQL несложно работать, потому что она поддерживает меньшее количество возможностей по сравнению с другими СУБД.
- При работе с MySQL доступен не только текстовый, но и графический режим. Приложение phpMyAdmin позволяет администрировать свою базу данных через браузер без знания SQL-команд.

MySQL — удобная, гибкая и хорошо работающая БД для крупных или средних проектов.

**MongoDB**

Относится к NoSQL-системам. MongoDB — документоориентированная СУБД с открытым исходным кодом. Для хранения данных применяется JSON-подобный формат. В ней используется язык запросов, обеспечивается несколько видов поиска: географический, текстовый и поиск по графам. Способна выдерживать большие нагрузки благодаря горизонтальному масштабированию.

**Особенности:**
- Не требуется описание схемы таблиц, как в реляционных БД. Данные хранятся в формате BSON (бинарных JSON-подобных документов).
- Между коллекциями отсутствуют сложные соединения типа JOIN, как между таблицами реляционных баз данных. Обычно соединение выполняется при сохранении данных благодаря объединению документов.
- Структура коллекций может различаться. У одного документа может быть один набор полей, в то время как у другого документа — совершенно другой (как тип, так и количество полей). MongoDB может хранить любые данные в формате JSON.

MongoDB можно использовать в мобильных приложениях, CMS-системах, играх, электронной коммерции — в любых сферах, где предполагается высокий уровень нагрузки. Для структурированных баз данных, а также если в будущем предполагается создание таких жестких схем, система применяется редко.

**PostgreSQL**

PostgreSQL относится к объектно-реляционному типу, свободно распространяется и работает на языках SQL и MySQL. Основное отличие от MySQL — в использовании инноваций и расширенном функционале.

Особенности:
- перегрузка функций и наследование таблиц;
- поддержка большого количества типов данных: JSON, XML, «ключ — значение», пространственных данных и многого другого;
- расширяемость, т.е. можно использовать готовые расширения, а также создавать собственные.

PostgreSQL подходит для хранения больших объемов данных, может обрабатывать сложные запросы. Способна выстраивать небольшие DWH (Data Warehouse), быть хранилищем для геоинформационных систем, мобильных игр, веб-приложений и т.д.

PostgreSQL не подойдет для работы с БД, где необходимо горизонтальное масштабирование, OLAP-хранилище, а также преобладают записи чтения.

**Elasticsearch**

Распределенная СУБД, основанная на Java-библиотеке Lucene. Способна поддерживать как структурированные, так и полуструктурированные данные. Это одна из самых масштабированных поисковых систем. Входит в группу Elastic Stack.

Особенности:

- поисковый сервер с открытым исходным кодом, который написан на Java;
- распределенное хранилище документов без схем, REST & JSON;
- веб-интерфейс REST API с выводом JSON;
- встроенный анализатор текстов;
- полнотекстовый поиск;
- поиск в реальном времени (NRT);
- поддержка разных языков и геолокации.

Подойдет для задач, в которых предполагается поиск в режиме реального времени большого объема структурированных данных. Это поисковики интернет-магазинов, веб-сайтов, хранение и мониторинг логов из большого количества источников, сервисы, занимающиеся разоблачением шпионских программ и мошенничества.

**SQLite**

Реляционная СУБД, которая выпускается в виде библиотеки на языке C.

Особенности:
- Встраивание в само приложение, а не работа по принципу «клиент — сервер». СУБД хранится на устройстве в виде локального файла: так она по умолчанию может быть встроена в некоторые телефоны и компьютеры.
- Поставка с нулевой конфигурацией, поэтому администрирование или настройка не требуются.
- Небольшой размер.
- Автономность, что означает отсутствие внешних зависимостей.
- SQLite-транзакции полностью совместимы с ACID, обеспечивают безопасный доступ к разным процессам или потокам.

SQLite подходит для работы с мобильными приложениями, веб-сайтами с небольшим трафиком, локальным кэшем, настольными приложениями (инструментами финансового анализа), интернетом вещей.

Для задач, которые предполагают отделение данных от приложения сетью, для сервисов с высоким трафиком, большого количества параллельных операций, больших объемов данных SQLite не подойдет. При этом СУБД способна работать с базами данных размером до 281 терабайта.

## 5 Модели данных в БД

**Модель данных** - это абстрактное, самодостаточное,логическое определение объектов, операторов и прочих элементов, в совокупности составляющих абстрактную машину доступа к данным, с которой взаимодействует пользователь. Упомянутые объекты позволяют моделировать структуру данных,а операторы - поведение данных. (_**по Дейту**_)

Используя это определение, можно эффективно разделить понятия модели данных и ее реализации.

**Реализация** (implementation) заданной модели данных - это физическое воплощение на реальной машине компонентов абстрактной машины, которые в совокупности составляют эту модель.

Короче говоря, модель - это то, о чем пользователи должны знать, а реализация это то, чего пользователи не должны знать.

Одним из первых специалистов, который достаточно формально определил это понятие, был Э. Кодд. Он определил **модель данных как комбинацию трех компонентов**:

- Коллекции типов объектов данных, образующих базовые строительные блоки для любой базы данных, соответствующей модели
- Коллекции общих правил целостности, ограничивающих набор экземпляров тех типов объектов, которые законным образом могут появиться в любой такой базе данных
- Коллекции операций,применимых к таким экземплярам объектов для выборки и других целей. (_**по Кодду**_)

Каждая БД и СУБД строится на основе некоторой явной или неявной модели данных. Все СУБД, построенные на одной и той же модели данных, относят к одному типу. Например, основой реляционных СУБД является реляционная модель данных,сетевых СУБД — сетевая модель данных,иерархических СУБД — иерархическая модель данных и т.д.

### 5.1 Важность моделей данных в СУБД

**Руководство по проектированию базы данных**. Модели данных помогают разрабатывать логические и физические конструкции баз данных, описывая, как данные будут организованы, тем самым устанавливая сущности, атрибуты и отношения.

**Обеспечьте согласованность данных**: определяя структуры и соглашения данных, модели данных обеспечивают единообразие во всех системах баз данных, тем самым поддерживая согласованность данных.

**Обеспечьте эффективное хранение и поиск данных**. Хорошо разработанная модель данных обеспечивает оптимальное хранение данных, более быстрые запросы и эффективный доступ к необходимой информации.

**Улучшение коммуникации**: модели данных служат визуальным и концептуальным справочником, который помогает устранить разрывы в общении между разработчиками, администраторами баз данных, участниками проекта и конечными пользователями. Они обеспечивают полное понимание предполагаемой структуры и использования базы данных.

**Упрощение управления данными**. Модели данных необходимы для управления данными, поскольку они помогают определить правила, ограничения и отношения, которые управляют данными, и помогают поддерживать качество и целостность данных.

#### 5.1.1 Иерархическая модель данных

Иерархическая модель данных - это структура организации данных, в которой информация организована в виде иерархической структуры, состоящей из уровней и подуровней. В этой модели каждый элемент данных связан с одним родительским элементом и может иметь один или несколько дочерних элементов.

Основные компоненты иерархической модели данных:

1. **Сегменты данных:** Данные организованы в виде сегментов или записей, которые представляют собой отдельные единицы информации.
2. **Родительские и дочерние элементы:** Каждый сегмент данных имеет родительский элемент и может иметь несколько дочерних элементов. Это создает иерархию, в которой каждый элемент данных связан с другими элементами в структуре.
3. **Связи:** Связи между элементами данных устанавливаются с использованием ключей, которые определяют отношения между родительскими и дочерними элементами.

Пример иерархической модели данных - это модель директорий и файловой системы операционной системы. В этой модели каждая директория (родительский элемент) может содержать файлы и другие директории (дочерние элементы), которые, в свою очередь, могут содержать свои собственные файлы и поддиректории.

Преимущества иерархической модели данных:

1. **Простота:** Иерархическая модель проста в понимании и использовании. Она хорошо подходит для представления иерархических отношений между данными.
2. **Эффективность доступа:** Доступ к данным в иерархической модели эффективен, поскольку каждый элемент имеет прямую ссылку на своего родителя.
3. **Хорошо подходит для иерархических структур данных:** Иерархическая модель идеально подходит для представления иерархических структур данных, таких как деревья, организационные структуры и иерархии категорий.

Однако у иерархической модели есть и недостатки, включая ограниченную гибкость и сложность в управлении связями между данными при изменениях структуры. Это привело к развитию других моделей данных, таких как сетевая модель и модель реляционных баз данных, которые предлагают более гибкие и мощные средства для организации и доступа к данным.

#### 5.1.2 Сетевая модель данных

Сетевая модель данных - это структура организации данных, в которой информация представлена в виде набора связанных между собой записей или узлов, образующих сеть. Эта модель была разработана как ответ на ограничения иерархической модели данных, предлагая более гибкий и мощный подход к организации и доступу к данным.

Основные компоненты сетевой модели данных:

1. **Сегменты данных:** Данные представлены в виде сегментов или записей, которые содержат информацию об объектах или сущностях.
2. **Типы записей:** Сетевая модель позволяет определять различные типы записей и их атрибуты, что позволяет создавать сложные структуры данных.
3. **Связи:** В сетевой модели данные организованы в виде сети, где каждая запись может быть связана с несколькими другими записями. Это позволяет представлять сложные связи между данными, такие как многие-к-многим.

Пример сетевой модели данных - это модель баз данных сетевых СУБД, таких как CODASYL DBTG (Conference on Data Systems and Languages Database Task Group). В этой модели каждая запись может иметь несколько родительских и дочерних записей, что позволяет представлять сложные иерархии и связи между данными.

Преимущества сетевой модели данных:

1. **Гибкость:** Сетевая модель позволяет представлять сложные структуры данных и связи между ними, что делает ее подходящей для моделирования различных бизнес-процессов и приложений.
2. **Эффективность доступа:** Доступ к данным в сетевой модели эффективен, поскольку каждая запись имеет прямую ссылку на связанные с ней записи.
3. **Поддержка сложных отношений:** Сетевая модель позволяет представлять сложные отношения между данными, такие как многие-к-многим, что часто встречается в реальных приложениях.

Однако у сетевой модели данных есть и недостатки, включая сложность в проектировании и поддержке, а также ограниченную распространенность на современном рынке баз данных, где более популярны реляционные и NoSQL базы данных.

#### 5.1.3 Реляционная модель данных

Реляционная модель данных - это структура организации данных, в которой информация представлена в виде таблиц, состоящих из строк и столбцов, где каждая строка представляет собой запись, а каждый столбец - атрибут или поле данных. Эта модель была предложена Эдгаром Коддом в конце 1960-х годов и стала основой для современных реляционных баз данных.

Основные компоненты реляционной модели данных:

1. **Таблицы:** Данные организованы в виде таблиц, каждая из которых имеет имя и состоит из набора строк и столбцов.
2. **Строки:** Каждая строка в таблице представляет собой запись или кортеж, содержащий значения атрибутов для конкретной сущности.
3. **Столбцы:** Каждый столбец в таблице представляет собой атрибут или поле данных, определяющее тип информации, которая будет храниться в каждой записи.
4. **Ключи:** Реляционные таблицы часто содержат ключи, которые однозначно идентифицируют каждую запись. Первичный ключ - это уникальный идентификатор каждой записи в таблице, а внешний ключ используется для связи между таблицами.

## 6 Нормализация БД

**Нормализация БД** - это процесс структурирования данных с целью минимизации избыточности и повышения целостности данных. Он включает в себя организацию таблиц и их атрибутов, чтобы уменьшить дублирование данных и упростить управление.

**Цель нормализации**: Минимизировать повторения данных и возможные структурные изменения БД при процедурах обновления. Это достигается декомпозицией одной таблицы в две или несколько с последующим использованием при запросах операции навигации. Заметим,что навигационный поиск снижает быстродействие БД, т.е. увеличивает время отклика на запрос.

**НОРМАЛЬНЫЕ ФОРМЫ БД**

Нормальные формы БД - это набор правил, которым должна соответствовать структура БД в процессе нормализации.

*Пояснение: NF (Нормальная форма)*

- 1NF: Таблица должна содержать только атомарные (неделимые) значения, каждая строка должна быть уникальной.
- 2NF: Таблица должна быть в 1NF, и все атрибуты должны зависеть от всего первичного ключа, а не от его части.
- 3NF: Таблица должна быть в 2NF, и все атрибуты должны зависеть только от первичного ключа, без транзитивных зависимостей.
- BCNF: (Нормальная форма Бойса-Кодда) Таблица должна быть в 3NF, и каждый детерминант должен быть ключом.
- 4NF: Таблица должна быть в BCNF, и не содержать многозначных зависимостей.
- 5NF: Таблица должна быть в 4NF, и каждое значение должно быть уникальным и неразделимым.

**Денормализация БД** - процесс, противоположный нормализации, который заключается в обьединении таблиц или добавлении избыточных данных с целью повышения производительности чтения.

## ER-модель

**ER-модель (Entity-Relationship Model)** - это концептуальная модель, используемая для структурирования и описания данных в БД. Она помогает визуализировать, как сущности (например, объекты или концепции) связаны между собой, и описывает, какие атрибуты эти сущности имеют.

**ER-диаграммы (Entity-Relationship Diagrams)** - это визуальные представления ER-моделей, которые помогают отображать и структурировать информацию о сущностях, их атрибутах и связях между ними. Они служат важным инструментом в процессе проектирования БД и позволяют легко понимать структуру данных и их взаимосвязи. 

**Визуальное представление**

- Сущности изображаются в виде прямоугольников.
- Атрибуты изображаются в виде овалов.
- Связи изображаются в виде ромбов.
- Обязательная связь (mandatory) - одна линия, соединяющая сущности.
- Необязательная связь (optional) - две линии, соединяющие сущности.

**Обязательная связь (Mandatory relationship)** - это связь, где одна сущность обязательно должна быть связана с другой.

**Необязательная связь (Optional relationship)** - это связь, где одна сущность можеть существовать без связи с другой.

> Пример ER-диаграммы
> 
> Предположим есть следующая ER-диаграмма для системы управления курсами:
> 
> - **Сущности**:    
> - `Студент` (с атрибутами: `ID`, `Имя`, `Фамилия`)
> - `Курс` (с атрибутами: `Код`, `Название`, `Описание`)
> - **Связь**:
> - `Студент` **(записывается на)** `Курс` (Эта связь обязательная, поскольку каждый студент должен быть записан на хотя бы один курс).
> - **Необязательная связь**:    
> - `Клиент` **(размещает)** `Заказ` (Эта связь необязательная, поскольку клиент может существовать, не размещая заказов).

### Сущности

**Сущности (Entities)** - это объекты или концепции, которые имеют независимое существование и о которых необходимо хранить данные. Например, в системе управления библиотекой сущностями могут быть `Книга`, `Читатель`, `Автор`.

Например, сущность `Книга` может иметь атрибуты, такие как `ISBN`, `Название`, `Автор`, `Год_издания`.

### Атрибуты

**Атрибуты (Attributes)** - это характеристики или свойства сущностей. Они представляют данные, которые нужно хранить для каждой сущности. Атрибуты могут быть различного типа, включая простые, составные и производные.

Атрибуты сущности в ER-модели представляют собой свойства, которые помогают описать каждую сущность и дают возможность хранить информацию о ней. Они отвечают на вопросы о том, что именно необходимо знать о сущности.

**Типы атрибутов**

- **Простые (Simple)**: Не подлежат делению (например, `Имя`, `Возраст`).
- **Составные (Composite)**: Могут быть разбиты на более мелкие компоненты (например, `Адрес`, состоящий из `Улица`, `Город`, `Штат`).
- **Производные (Derived)**: Вычисляются на основе других атрибутов (например, `Возраст`, вычисляемый на основе `Дата_рождения`).
- **Множественные (Multi-valued)**: Могут принимать несколько значений (например, `Телефоны`, где у одного пользователя может быть несколько номеров).

### Связи

**Связи (Relationships)** описывают, как сущности взаимодействуют друг с другом. Они могут быть односторонними или двусторонними и могут иметь различные кардинальности (например, "один к одному", "один ко многим", "многие ко многим").

**Примеры связей**

- Связь между `Читателем` и `Книгой` может быть "Читатель может взять много книг", а "Книга может быть взята многими читателями", что представляет собой связь "многие ко многим".
- Связь между `Автором` и `Книгой` может быть "Один автор может написать много книг", что представляет собой связь "один ко многим".

## ACID

**ACID** - это акроним, который описывает четыре основных свойства, обеспечивающих надежность транзакций в реляционных базах данных.

**Atomicity (Атомарность)**:

- Гарантирует, что все операции в рамках транзакции выполняются полностью или не выполняются вовсе. Если одна часть транзакции не может быть выполнена, вся транзакция откатывается.
- Пример: В процессе перевода денег с одного счета на другой обе операции (списание с одного счета и зачисление на другой) должны завершиться успешно. Если одна из них не удалась, изменения не будут применены.

**Consistency (Согласованность)**:

- Гарантирует, что транзакция переводит базу данных из одного согласованного состояния в другое. Все правила и ограничения (например, ограничения целостности) должны соблюдаться.
- Пример: После перевода денег, сумма денег на одном счёте должна уменьшиться на ту же сумму, на которую она увеличилась на другом счёте.

**Isolation (Изолированность)**:

- Гарантирует, что выполнение нескольких транзакций одновременно не повлияет на друг друга. Каждая транзакция должна выполняться как будто она единственная, работающая с базой данных.
- Пример: Если два пользователя одновременно пытаются перевести деньги с одного и того же счёта, изолированность гарантирует, что результаты каждой транзакции будут корректными.

**Durability (Надежность)**:

- Гарантирует, что после успешного завершения транзакции все изменения будут сохранены в базе данных даже в случае сбоя системы.
- Пример: Если транзакция завершилась успешно, но затем произошло отключение электроэнергии, изменения всё равно сохранятся и будут доступны при следующем подключении.

## CAP

CAP теорема (также известная как теорема Бэра) описывает три основные свойства, которые система может гарантировать в распределённых системах.

**Consistency (Согласованность)**:

- Все узлы системы видят одни и те же данные в одно и то же время. После завершения записи данные будут доступны для всех узлов.
- Пример: В распределённой базе данных, если один узел обновляет запись, все остальные узлы должны видеть это обновление.

**Availability (Доступность)**:

- Каждый запрос к системе всегда получает ответ (успешный или с ошибкой), даже если некоторые узлы недоступны.
- Пример: Если один из узлов сбойнул, остальные узлы всё равно должны оставаться доступными для обработки запросов.

**Partition Tolerance (Толерантность к разделению)**:

- Система продолжает функционировать, даже если связь между некоторыми узлами нарушена (разделение сети).
- Пример: Если сеть между двумя узлами разрывается, система должна продолжать работать, сохраняя доступность и согласованность на оставшихся узлах.


## Вопросы

- Что такое ACID, CAP?
- Как работают UNION запросы, что производительнее?
- Что такое снежинка, звездочка, типы связей?
- Что такое агрегация? В чем отличие оконных функций от агрегации?
- Что такое ER-диаграммы, optional, mandatory?
- Что такое ER-модели (отношения, атрибуты, связи)? Что концептуально представляют собой атрибуты сущности в ER-модели?
- Реляционные и нереляционные СУБД?
- Какие процедуры есть в SQL?
- Что такое подзапросы, их плюсы и минусы?
- Что такое представления, материализованные представления, недостатки и преимущества?
- Что такое тригерные функции и для чего?
- Что такое CHECK constraint, индексы, ключи?
- Составить запросы с:
	1. NULL в запросах;  
	2. JOIN (LEFT, RIGHT, FULL, CROSS, NATURAL), UNION, INTERSECT;  
	3. NULL FIRST, NULL LAST при сортировке;  
	4. SELECT DISTINCT, LIMIT, NOT EXISTS;  
	5. ROW_NUMBER, OVER.