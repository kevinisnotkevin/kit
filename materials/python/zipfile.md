# ZIPFILE

> Модуль предоставляет инструменты для создания, чтения, записи, добавления, вывода ZIP-файла. Может обрабатывать ZIP-файлы, использующие ZIP64 расширение (т.е. размером не более 4ГиБ). Поддерживает расшифровку зашифрованных файлов в ZIP-архивах, но не может создать зашифрованных файл. Расшифровка происходит медленно, так как реализация на Python, а не на Си.

## Использование

- Работа с ZIP архивами.

## Примеры

```python
# Извлечение файлов из существующего ZIP-архива.
with zipfile.ZipFile('example.zip', 'r') as myzip:
    myzip.extractall('extracted_folder')


# Добавление нового файла в существующий ZIP-архив.
with zipfile.ZipFile('example.zip', 'a') as myzip:
    myzip.write('new_file.txt')


# Получение информации о содержимом ZIP-архива.
with zipfile.ZipFile('example.zip', 'r') as myzip:
    file_list = myzip.namelist()
    file_info = myzip.getinfo('file.txt')
```

## Чтение ZIP-файла

Чтобы прочитать содержимое ZIP-файла, прежде всего необходимо создать объект `ZipFile` (обратите внимание на использование прописных букв ’Z’ и ’F' в имени объекта). Объекты `ZipFile` концептуально напоминают объекты `File`, возвращаемые функцией `open()`

Для создания объекта `ZipFile` следует вызвать функцию `zipfile.ZipFile()`, передав ей строку с именем ZIP-файла.

```python
import zipfile


pth = Path.cwd()
exampleZip = zipfile.ZipFile(pth / 'Example.zip')
print(exampleZip.namelist())
pyinfo = exampleZip.getinfo('1.py')
print(pyinfo.file_size)
print(pyinfo.compress_size)
print(f'Сжатый файл в {round(pyinfo.file_size / pyinfo.compress_size, 2)} раза меньше!')
```

У объекта `ZipFile` есть метод `namelist()`, который возвращает список строк с именами всех файлов и папок, содержащихся в ZIP-архиве. Эти строки можно передать методу `getinfo()` объекта `ZipFile`, который вернет объект `ZipInfo`, содержащий информацию об указанном файле.

Объекты `ZipInfo` имеют такие атрибуты, как `file_size` и `compress_size`, определяющие соответственно размеры исходной и сжатой версии файла в байтах. Объект `ZipFile` представляет весь архивный файл, тогда как объект `ZipInfo` хранит полезную информацию об отдельном файле в сжатом архиве.

## Извлечение файлов из ZIP-архива

Метод `extractall()` объекта `ZipFile` извлекает все файлы и папки из ZIP-архива в текущий каталог.

```python
pth = Path.cwd()

exampleZip = zipfile.ZipFile(pth / 'Example.zip')
exampleZip.extractall(pth / 'exampleZip')
exampleZip.close()
```

После выполнения этого кода содержимое файла `Example.zip` будет извлечено в текущий каталог. В качестве необязательного параметра методу `extractall()` можно передать имя папки, что позволит извлекать файлы в папку, не являющуюся текущим каталогом. Если указанной папки не существует, то она будет создана.

Метод `extract()` объекта `ZipFile` извлекает одиночный файл из ZIP-архива.

```python
pth = Path.cwd()

exampleZip = zipfile.ZipFile(pth / 'Example.zip')
exampleZip.extract('1.py', pth / 'some/new/folder')
exampleZip.close()
```

Передаваемая методу `extract()` строка должна соответствовать одной из строк в списке, возвращаемом методом `namelist()`. Методу `extract()` можно также передать необязательный второй параметр, позволяющий извлечь файлы в папку, не являющуюся текущим каталогом. Если этой папки не существует, Python создаст ее. Метод `extract()` возвращает абсолютный путь, куда был распакован данный файл.

## Создание ZIP-файлов и добавление в них новых файлов

Чтобы создать собственный ZIP-файл, необходимо создать объект `ZipFile` в режиме записи, передав конструктору аргумент ’`w`’. (Это аналогично открытию текстового файла в режиме записи путем передачи строки '`w`’ методу `open()` в качестве второго аргумента.)

Когда вы передаете путь методу `write()` объекта `ZipFile`, Python сжимает файл, расположенный по указанному пути, и добавляет его в ZIP-файл. Первый аргумент метода `write()` — это строка с именем добавляемого файла. Второй аргумент задает тип сжатия, указывая, какой алгоритм следует применять для сжатия файлов. Это значение можно всегда устанавливать равным `zipfile.ZIP_DEFLATED` (данный алгоритм сжатия достаточно хорошо работает со всеми типами данных).

```python
newZip = zipfile.ZipFile('new.zip', 'w')
newZip.write('spam.txt', compress_type=zipfile.ZIP_DEFLATED)
newZip.close()
```

В данном случае создается новый ZIP-архив `new.zip`, содержащий файл `spam.txt`.

Имейте в виду, что, как и при обычной записи файлов, все существующее содержимое ZIP-файла в режиме записи удаляется. Если хотите добавить файлы в существующий ZIP-файл, передайте методу `zipfile.ZipFile()` в качестве второго параметра строку ’`а`’, чтобы открыть ZIP-файл в режиме добавления.
