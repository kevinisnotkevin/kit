# Clickjacking



__Clickjacking__ – атака, при которой пользователь неосознанно кликает на элементы веб-страницы, предполагая, что он взаимодействует с другим контентом. Злоумышленник накладывает невидимый фрейм поверх страницы, которую пользователь видит.



## Способы защиты Clickjacking
- Заголовки безопасности, такие как X-Frame-Options или Content Security Policy (CSP). Работает на уровне HTTP, до загрузки какого-либо содержимого пользователя. Когда X-Frame-Options установлен в DENY, он полностью запрещает отображение страницы в фрейме. Когда установлен в SAMEORIGIN, страница может отображаться в фрейме только на том же домене. Также можно использовать CSP с директивой frame-ancestors, которая позволяет более гибко контролировать, какие источники могут встроить страницу во фрейм. Пример CSP: Content-Security-Policy: frame-ancestors ‘self’ https://example.com. Этот CSP разрешает встраивание страницы только если она открыта непосредственно на собственном домене self или на домене https://example.com.
- Скрипты, которые обнаруживают попытки встраивания страницы в фрейм. Пример JS, который обнаруживает, если веб-страницы загружаются внутри фрейма, и предпринимает действия для предотвращения кликджекинга:
```js
if (window.top !== window.self) {
    window.top.location = window.location;
}
```
- В этом скрипте window.top ссылается на самый верхний фрейм в иерархии вложенных фреймов. window.self ссылается на текущее окно. Если они не равны, значит, страница загружены внутри фрейма, и скрипт перенаправляет браузер на настоящую веб-страницу, выходя из внешнего фрейма.
- Визуальная индикация. Иногда можно использовать техники, которые служат для визуальной индикации того, что элементы интерфейса безопасны для взаимодействия. Пример: добавление шума или водяных знаков в фон, чтобы осложнить создание злоумышленниками невидимых фреймов.
