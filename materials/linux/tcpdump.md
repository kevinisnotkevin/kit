# TCPDUMP

**Tcpdump** - очень мощный и широко используемый сетевой сниффер командной строки. Он используется для захвата и анализа пакетов TCP/IP, переданных или полученных по сети на определенном интерфейсе.

При вызове обязательно нужно передать интерфейс для отслеживания. Если интерфейс не указать, то будет использован первый в списке.

Основные опции:
- **A** - выводить все пакеты в формате ASCII;
- **c** - закрыть программу после перехвата n-ого количества пакетов;
- **C** - при записи пакетов в файл, проверять размер файла, и если он больше заданного - создать новый файл;
- **D** - вывести список доступных сетевых интерфейсов;
- **e** - выводить информацию уровня соединения для каждого пакета, это может быть полезно, например, для отображения MAC адреса;
- **f** - выводить доменное имя для ip адресов;
- **F** - читать пакеты из файла, а не интерфейса;
- **G** - создавать новый файл лога через указанный промежуток времени;
- **H** - обнаруживать заголовки 802.11s;
- **i** - имя интерфейса для перехвата пакетов. Вы можете захватывать пакеты со всех интерфейсов, для этого укажите any;
- **I** - переключить интерфейс в режим монитора для захвата всех проходящих пакетов;
- **j** - установить формат Timestamp для записи пакетов;
- **J** - посмотреть доступные Timestamp;
- **K** - не проверять контрольные суммы пакетов;
- **l** - добавить поддержку прокрутки к выводу;
- **L** - вывести поддерживаемые протоколы подключения для интерфейса;
- **n** - не отображать доменные имена;
- **r** - прочитать пакеты из файла, созданного с помощью -w;
- **v, -vv, -vvv** - более подробный вывод;
- **q** - выводить минимум информации;
- **w** - записать вывод в файл;
- **Z** - пользователь, от имени которого будут создаваться файлы.

```bash
# Перехват пакетов, проходящих через интерфейс eth0
tcpdump -i eth0

# Перехват пакетов, проходящих через порт 80 без изменения IP в имена
tcpdump -n port 80

# Перехвать 10 пакетов и запись их в файл
tcpdump -c 10 -w capture.pcap
```
