# Stdin, Stdout, Stderr

Оболочка bash имеет три основных потока. Она принимает входные данные из stdin (поток 0), отправляет выходные данные в stdout (поток 1) и отправляет сообщения об ошибках в stderr (поток 2). Клавиатура часто служит в качестве stdin, тогда как stdout и stderr выводятся на дисплей. Отделение выходных данных от ошибок может быть очень полезным.

**Cтандартный вывод stdout** может быть перенаправлен со знаком больше, чем. При сканировании строки оболочка увидит знак > и очистит файл. Обозначение > на самом деле является аббревиатурой 1> (стандартный вывод упоминается как поток 1). 1> - это то же самое, что >.

**Используйте >> для добавления выходных данных в файл.**

**Перенаправление ошибок stderr**. Перенаправление stderr выполняется с помощью 2>. Это может быть очень полезно для предотвращения загромождения экрана сообщениями об ошибках.

По умолчанию вы не можете выполнять grep внутри stderr при использовании каналов в командной строке, поскольку передается только стандартный вывод. С помощью 2>&1 вы можете принудительно перевести stderr в стандартный вывод. Это позволяет команде в канале воздействовать на оба потока.

**Файловый дескриптор** - это натуральное число (идентификатор), закреплённое за определённым потоком ввода-вывода. В Linux библиотека libc открывает для каждого запущенного процесса 3 файл дескриптора, с номерами 0, 1, 2:

- Файл дескриптор 0 называется STDIN и ассоциируется с вводом данных у приложения;
- Файл дескриптор 1 называется STDOUT и используется приложениями для вывода данных, например командами print;
- Файл дескриптор 2 называется STDERR и используется приложениями для вывода данных, сообщающих об ошибке.

```bash
# Перенаправление стандартного ввода
cat < stdout.txt

# Перенаправление результата работы функции find в функцию grep, а затем перенаправление в функцию wc
find /etc/ -name *.conf 2>/dev/null | grep systemd | wc -l

# Перенаправление файлового дескриптора ошибок на нулевое устройство, которое отбрасывает все данные и перенаправление файлового дескриптора вывода в файл results.txt. `>` создает или перезаписывает файл, `>>` добавляет в файл
find /etc/ -name shadow 2>/dev/null > results.txt
# Явное перенаправление стандартного вывода:
find /etc/ -name shadow 2> stderr.txt 1> stdout.txt

# Перенаправление stdout и stderr в один и тот же файл
find / > allfiles_and_errors.txt 2>&1

# Нельзя использовать как 1>&2, так и 2>&1 для переключения stdout и stderr. Нужен третий поток для переключения stdout и stderr после символа канала
rm file1 3>&1 1>&2 2>&3 | sed 's/file1/FILE1/'

# Конструкция &> поместит как stdout, так и stderr в один поток (в файл)
rm file1 &> out_and_err
```
