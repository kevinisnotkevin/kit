# PAM

Подключаемые модули аутентификации РАМ (Pluggable Authentication Modules) - модули, которые предоставляют администраторам дополнительные методы подтверждения подлинности пользователя. 

Модули РАМ - это не новинка в мире Linux. Они были разработаны очень давно, но до сих пор есть даже в самых современных дистрибутивах Linux, поскольку заменить их, по сути, нечем.

Модули РАМ позволяют использовать несколько схем аутентификации. Большинство приложений, которые нуждаются в проверке подлинности пользователя, используют РАМ. Модули РАМ позволяют реализовать альтернативную аутентификацию, например, по отпечаткам пальцев или по сетчатке глаз, но для этого необходимо дополнительное оборудование, например, сканер отпечатков. В этой книге мы рассмотрим традиционный вариант использования РАМ - когда аутентификация происходит посредством ввода пароля с клавиатуры.

Основной файл конфигурации называется /etc/pam.conf. В каталоге /etc/pam.d/ находится конфигурация для разных сервисов, которые поддерживают РАМ, например, в /etc/pam.d/sshd находится конфигурация РАМ-модулей для SSH, в /etc/pam.d/gdm-passwd - конфигурация пароля для менеджера дисплея GDM и т.д. В каталоге /etc/security также есть файлы конфигурации, относящиеся к РАМ, например, файл ассеss.соnf управляет доступом в систему.

Безопасность вашей системы зависит от используемых вами модулей. Модули хранятся в каталоге /lib/security или /lib64/security (для 64-битных систем), однако некоторые дистрибутивы не следуют этому стандарту. К примеру, в некоторых системах модули можно найти в каталоге /usr/lib/security. При желании можно написать и собственные модули (см. раздел Источники информации), но для начала следует разобраться с уже имеющимися. Ниже приведен список наиболее часто используемых модулей. Больше информации по каждому из них можно получить, набрав man модуль, к примеру man pam_pwcheck. Обратите внимание, что нет "стандартного списка" модулей. Их состав варьируется от дистрибутива к дистрибутиву.

- **pam_access** - разрешает или запрещает доступ, в зависимости от IР-адреса, имени пользователя, имени хоста или доменного имени и т.п. По умолчанию, правила доступа определены в файле /etc/security/access.conf. Когда пользователь входит, проверяются правила доступа до первого совпадения, и делается решение, разрешить или запретить доступ. Также смотри модуль pam_time - там другие ограничения.
- **pam_cracklib и pam_pwcbeck** - предоставляют функции проверки прочности пароля (проверки на легкость угадывания или повторяемость). У пользователя спрашивают пароль, и если он проходит предустановленные правила и считается прочным, тогда нужно ввести его еще раз для проверки правильности ввода.
- **pam_deny** - безусловно запрещает доступ: Этот модуль можно использовать для блокирования пользователей, как политику по умолчанию cмотрите также pam_permit.
- **pam_ecbo** - выводит предустановленное текстовое сообщение смотрите также pam motd.
- **pam_env** - позволяет присвоение значений переменных окружения. Правила по умолчанию берутся из файла /etc/security/pam_env.conf.
- **pam_exec** - вызывает внешнюю программу.
- **pam_lastlog** - выводит дату и время последнего входа в систему.
- **раm_limits** - устанавливает ограничения на системные ресурсы, используемые пользователем. Ограничения по умолчанию берутся из файла /etc/security/limits.conf.
- **pam_Iistfile** - разрешает или запрещает сервис в зависимости от значений в файле. К примеру, ecли нужно открыть FТР-доступ лишь для некоторых пользователей, перечень которых указан в файле /etc/ftpusers ok
- **pam_mail** - сообщает пользователю о наличии свежей электронной почты.
- **pam_mkhomedir** - создает домашний каталог пользователя, если он не существует на локальной машине. Таким образом, можно использовать централизованную авторизацию (к примеру, в NIS или LDAP) и создавать домашние каталоги лишь при необходимости.
- **раm_mоtd** - выводит “сообщение дня”. смотрите также модуль pam_echo.
- **pam_nologin** - запрещает доступ, когда существует файл /etc/nologin .
- **pam_permit** - безусловно разрешает доступ - очень небезопасно! См. также модуль pam_ deny.
- **pam_rootok** - разрешает доступ для пользователя root без дополнительных проверок. Обычно этот модуль используется в /etc/pam.d/su, чтобы пользователь root мог войти под любым другим пользователем даже без ввода пароля. Файл должен содержать следующие строки (обратите внимание на вторую строку, см. модуль pam wheel):
    - `auth sufficient pam_rootok.so`
    - `auth required pam_wheel.so`
    - `auth required pam_unix.so`
- **pam_succecd_if** - проверяет некоторые характеристики учетной записи, к примеру, принадлежность к определенной группе, значение UID и т.п.
- **pam time** - запрещает доступ к службе в зависимости от дня недели и времени дня. По умолчанию правила берутся из файла /etc/security/time. conf. Однако, запрет накладывается лишь на момент входа в систему. Способа принудительно заставить пользователя выйти из системы нет.
- **pam_umask** - устанавливает маску создания файлов.
- **pam_unix или раm_uniх2** - классическая аутентификация в UNIХ-стиле, основана на файлах /etc/passwd и /etc/shadow. смотрите также модуль pam_userdb.
- **pam userdb** - аутентифицирует пользователя с помощью базы данных. смотрите также модуль pam_unix.
- **pam warn** - заносит название службы, номер терминала, пользователя и другие данные в системный журнал. Модуль можно использовать везде, он не влияет на процесс аутентификации.
- **pam wheel** - позволяет rооt-доступ лишь для членов группы wheel. Часто этот модуль используется для su, чтобы лишь избранные пользователи могли пользоваться этой программой. Пример использования можно найти в описании модуля pam_rootok.
