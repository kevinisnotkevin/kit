# Защита сегментов сети. ACL

ACL - cписки контроля доступа, которые определяют, кто или что может получать доступ к объекту и какие именно операции разрешено или запрещено выполнять субъекту.

1. Стандартные ACL. Могут проверять только адреса источников
2. Расширенные ACL. Могут проверять адреса источников, а также адреса получателей, тип протокола

## Стандартные списки доступа в CISCO

```
Router(config)# access-list <номер списка от 1 до 99> {permit | deny | remark}
{address | any | host} [source-wildcard] [log]

```

- permit: **разрешить трафик**
- deny: **запретить трафик**
- any: **действие будет распространяться на все**
- host: **действие будет распространяться только на один хост**
- address: **разрешаем или запрещаем сеть**
- log: **включаем логирование**

## Расширенные списки доступа в CISCO

```
Router(config)#access-list <номер списка от 100 до 199> {permit | deny | remark}
protocol source [source-wildcard] [operator operand]
[port <порт или название протокола> [established]

```

- protocol source: **какой протокол будем разрешать или закрывать (ICMP, TCP, UDP, IP, OSPF и т.д)**
- port: **номер порта (TCP или UDP), можно указать имя**
- established: **разрешаем прохождение TCP-сегментов, которые являются частью уже созданной TCP-сессии**
- operator: _A.B.C.D — адрес получателя any — любой конечный хост eq — только пакеты на этом порт еgt — только пакеты с большим номером порта host — единственный конечный хост lt — только пакеты с более низким номером порта neq — только пакеты не на данном номере порта range — диапазон портов_





Благодаря этой технологии обеспечивается фильтрация на сетевом и транспортном уровне модели OSI, позволяя определить, могут ли компьютеры взаимодействовать друг с другом. Технология работает на основе ip адресов и номеров портов.

Обычно ACL разрешает или запрещает IP-пакеты, но помимо всего прочего он может заглядывать внутрь IP-пакета, просматривать тип пакета, TCP и UDP порты. Также ACL существует для различных сетевых протоколов (IP, IPX, AppleTalk и так далее).

Достоинства:
- Производительность сети - можно повысить, разрешив только соответствующим службам обмениваться данными с устройствами сети
- Защита сети - в сетевой среде пользователям может быть ограничен доступ к конфиденциальным службам
- Контроль трафика - разрешает и запрещает трафик, в зависимости от потребностей сети

ACL разделяются на два типа:
- Стандартные ACL - могут проверять только адреса источников
- Расширенные ACL - могут проверять адреса источников, а также адреса получателей, в случае IP ещё тип протокола и TCP/UDP порты

## Настройка

Сами ACL создаются отдельно, то есть это просто некий список, который создается в глобальном конфиге, потом он присваивается к интерфейсу и только тогда он и начинает работать. Необходимо помнить некоторые моменты, для того, чтобы правильно настроить списки доступа:
- Обработка ведется строго в том порядке, в котором записаны условия
- Если пакет совпал с условием, дальше он не обрабатывается
- В конце каждого списка доступа стоит неявный deny any (запретить всё)
- Расширенные ACL нужно размещать как можно ближе к источнику, стандартные же как можно ближе к получателю
- Нельзя разместить более 1 списка доступа на интерфейс, на протокол, на направление
- ACL не действует на трафик, сгенерированный самим маршрутизатором
- Для фильтрации адресов используется WildCard маска

## Базовые списки контроля доступа

Конфигурирование списков доступа производится в два этапа:
1. Создание списка доступа в режиме глобального конфигурирования
2. Привязка списка доступа к интерфейсу в режиме детального конфигурирования интерфейса

```
Router(config)#access-list <номер списка от 1 до 99> {permit | deny | remark} {address | any | host} [source-wildcard] [log]
```
- Создание стандартного списка доступа
- permit: _разрешить_
- deny: _запретит_
- remark: _комментарий о списке доступа_
- address: _запрещаем или разрешаем сеть_
- any: _разрешаем или запрещаем всё_
- host: _разрешаем или запрещаем хосту_
- source-wildcard: _WildCard маска сети_
- log: _включаем логгирование пакеты проходящие через данную запись ACL_

```
Router(config-if)#ip access-group <номер списка или имя ACL>{in | out}
```
- Прикрепляем к интерфейсу
- in: _входящее направление_
- out: _исходящее направление_

## Расширенные списки контроля доступа

```
Router(config)#access-list <номер списка от 100 до 199>{permit | deny | remark} protocol source [source-wildcard] [operatoroperand] [port <порт или название протокола> [established]
```
- Конфигурирование расшренных списков доступа
- protocol source: _какой протокол будем разрешать или закрывать (ICMP, TCP, UDP, IP, OSPF и т.д)_
- deny: _запретить_
- operator:
    - _A.B.C.D — адрес получателя_
    - _any — любой конечный хост_
    - _eq — только пакеты на этом порте_
    - _gt — только пакеты с большим номером порта_
    - _host — единственный конечный хост_
    - _lt — только пакеты с более низким номером порта_
    - _neq — только пакеты не на данном номере порта_
    - _range — диапазон портов_
- port: _номер порта (TCP или UDP), можно указать имя_
- established: _разрешаем прохождение TCP-сегментов, которые являются частью уже созданной TCP-сессии_

```
Router(config-if)#ip access-group <номер списка или имя ACL>{in | out}
```
- Прикрепляем к интерфейсу
- in: _входящее направление_
- out: _исходящее направление_