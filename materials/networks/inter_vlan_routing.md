# Inter VLAN routing

VLAN не могут обмениваться данными без вмешательства устройства маршрутизации. Всякий раз, когда узлам одной сети VLAN необходимо обмениваться данными с узлами другой сети VLAN, трафик должен направляться через устройство маршрутизации. Этот процесс известен как маршрутизация между VLAN. Для успешного обмена информацией между VLAN вам понадобится маршрутизатор или коммутатор уровня 3. Существует три возможных способа реализации маршрутизации между VLAN:

- Traditional Inter-VLAN Routing
- Router-on-a-Stick Inter-VLAN Routing
- Multilayer Switch Inter-VLAN Routing

**Traditional Inter-VLAN Routing**

Этот метод маршрутизации между VLAN основан на маршрутизаторе с несколькими физическими интерфейсами. Каждый интерфейс обычно подключается к коммутатору, по одному на каждую VLAN. Порты коммутатора, подключенные к маршрутизатору, переводятся в режим доступа, после чего каждый интерфейс маршрутизатора может принимать трафик из сети VLAN, связанной с интерфейсом коммутатора, к которому он подключен, и трафик может направляться в другие сети VLAN, подключенные к другим интерфейсам. Это означает, что каждый из IP-адресов интерфейсов маршрутизаторов станет адресом шлюза по умолчанию для каждого хоста в каждой VLAN.

**Router-on-a-Stick Inter-VLAN Routing**

Router-on-a-stick — это метод маршрутизации между VLAN, при котором маршрутизатор подключается к коммутатору с использованием одного физического интерфейса, отсюда и название «router-on-a-stick». Большинство современных реализаций маршрутизации между VLAN разработаны с использованием этого метода. В отличие от традиционного метода маршрутизации между VLAN, Router-on-stick не требует нескольких физических интерфейсов как на маршрутизаторе, так и на коммутаторе. Вместо этого операционная система маршрутизатора позволяет настроить интерфейс маршрутизатора для работы в качестве транкового канала, который затем подключается к порту коммутатора, настроенному в транковом режиме. Это означает, что на маршрутизаторе и коммутаторе требуется только один физический интерфейс для маршрутизации пакетов между несколькими VLAN. Протокол IEEE 802.1Q (Dot1q), определяющий систему маркировки VLAN для кадров Ethernet, используется для обеспечения поддержки VLAN различных производителей. Единственный физический интерфейс на маршрутизаторе связан с логическими (виртуальными) субинтерфейсами, которые можно настроить с несколькими IP-адресами, соответствующими VLAN на коммутаторе. Каждый субинтерфейс настроен для разных подсетей, соответствующих их назначению VLAN, для упрощения логической маршрутизации. Маршрутизатор выполняет маршрутизацию между VLAN, принимая трафик из всех VLAN. Затем он определяет сеть назначения на основе исходного и целевого IP-адресов в пакетах. После принятия решения о маршрутизации на основе целевой VLAN кадры данных пересылаются на коммутатор с правильной информацией о VLAN через тот же физический интерфейс, который использовался для получения трафика.

**Multilayer Switch Inter-VLAN Routing**

Многоуровневый коммутатор Маршрутизация между сетями VLAN — это метод маршрутизации между сетями VLAN, при котором для выполнения функций маршрутизации используется коммутатор другого типа, известный как многоуровневый коммутатор. Многоуровневый коммутатор — это гибридное устройство, которое сочетает в себе функции коммутатора и маршрутизатора, что позволяет ему работать как на уровне 2 (L2), так и на уровне 3 (L3) модели OSI, отсюда и название «многоуровневый». В отличие от метода маршрутизации между сетями VLAN на основе маршрутизатора, для маршрутизации между сетями VLAN многоуровневого коммутатора не требуется выделенный маршрутизатор — все происходит внутри коммутатора. Многоуровневые коммутаторы выполняют все функции маршрутизации VLAN в сети, тем самым устраняя необходимость в выделенных маршрутизаторах или магистральных каналах.

Чтобы многоуровневый коммутатор мог выполнять функции маршрутизации, используются логические (виртуальные) интерфейсы, известные как Switch Virtual Interface (SVI), по одному на каждую VLAN. SVI, также известный как интерфейс VLAN, представляет собой виртуальный маршрутизируемый интерфейс, который соединяет VLAN на устройстве с механизмом маршрутизации уровня 3 в том же устройстве и может быть настроен с несколькими IP-адресами, соответствующими VLAN на коммутаторе. Каждый SVI настроен для разных подсетей, соответствующих назначенной им VLAN, для упрощения логической маршрутизации.
