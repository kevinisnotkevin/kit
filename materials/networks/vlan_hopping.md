# VLAN Hopping

![](materials/images/networks/vlan_hopping.png)

**Switch Spoofing**
Уязвимость заключается в отсутствии правильной конфигурации сетевых интерфейсов коммутатора. Если мы явно не определим, что пользовательские интерфейсы являются access, а соединения с другими коммутаторами являются trunk, то злоумышленник, подключившись к произвольному порту коммутатора может с помощью специальной команды объявить устройству, что его компьютер тоже является коммутатором. Тогда интерфейс коммутатора будет переведен в режим trunk. Как мы разобрали на предыдущем занятии, trunk интерфейс пропускает трафик без изменения метки VLAN. Соответственно, злоумышленник может сам назначать своему трафику произвольную метку vlan, что поместит его в сеть, ассоциированную с выбранным vlan тегом. А уже из этого следует тот факт, что устройство злоумышленника может не пользоваться маршрутизацией между сетями - достаточно будет просто отправить тегированный трафик.

**Double Tagging**
Ещё существует атака на VLAN с двойным тегированием. Компьютер злоумышленника помещает в кадр два тега vlan и отправляет на коммутатор, который не ожидает, что на access порт придет тегированный трафик. Коммутатор снимает внешний тег vlan, но о существовании второго тега не подозревает. По итогу трафик с тегом проходит далее по инфраструктуре и оказывается в vlan, который нужен злоумышленнику. Минус такой атаки в том, что она однонаправленная. Обратно от атакуемого хоста трафик к нам не дойдет.