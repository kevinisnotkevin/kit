# SAMBA LAB

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π–ª–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ

### –ó–∞–¥–∞—á–∞:
- –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–∞–ø–∫–∞–º –∏ —Ñ–∞–π–ª–∞–º –Ω–∞—Ö–æ–¥—è—â–∏–º—Å—è –Ω–∞ —Ñ–∞–π–ª–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ Linux, –∫–ª–∏–µ–Ω—Ç–æ–º Linux
- –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–∞–ø–∫–∞–º –∏ —Ñ–∞–π–ª–∞–º –Ω–∞—Ö–æ–¥—è—â–∏–º—Å—è –Ω–∞ —Ñ–∞–π–ª–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ Linux, –∫–ª–∏–µ–Ω—Ç–æ–º Windows
- –î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å Samba –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É OS Linux
- –ù–∞—Å—Ç—Ä–∏—Ç—å Samba —Ä–µ—Å—É—Ä—Å —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º share –∏ –¥–∞—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ –≥—Ä—É–ø–ø–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π users, –Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏ –¥–ª—è –≥—Ä—É–ø–ø—ã —Å –∏–º–µ–Ω–µ–º admins, –∞ —Ç–∞–∫–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é PT, –¥–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª `/etc/samba/smb.conf`.
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã –¥–ª—è –æ–±—â–µ–≥–æ —Ä–µ—Å—É—Ä—Å–∞ (–¥–ª—è —Ç–µ—Ö –∫–æ–º—É –ø–æ–∫–∞–∑–∞–ª–æ—Å—å –ª–µ–≥–∫–æüôÇ) -- –ø–æ—è—Å–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `smbstatus` (_–ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å, –ø–æ—è—Å–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç_) -- –∑–∞–ø–∏—Å–∞—Ç—å –≤—ã–≤–æ–¥ –≤ —Ñ–∞–π–ª .txt


**–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ç—Ä–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã:**
1. Unix-—Å–µ—Ä–≤–µ—Ä
2. Unix-–∫–ª–∏–µ–Ω—Ç
3. Windows-–∫–ª–∏–µ–Ω—Ç

–î–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ö Linux –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç SAMBA. –ù–∏–∂–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –¥–µ–π—Å—Ç–≤–∏—è –ø–æ –µ–≥–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ.

- –ü—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ —Å–ª–µ–¥—É–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –±–∞–∑—É –ø–∞–∫–µ—Ç–æ–≤: `apt-get update`
- –î–∞–ª–µ–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç—ã –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: `apt-get install -y samba samba-client`
- –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Samba: `cp /etc/samba/smb.conf /etc/samba/smb.conf.bak`
- –°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –≤—ã–±–µ—Ä–µ—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –∫ –∫–æ—Ç–æ—Ä–æ–π –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –∏–º–µ—Ç—å –æ–±—â–∏–π –¥–æ—Å—Ç—É–ø: `mkdir -p /samba/public`
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ —ç—Ç–æ–º—É –∫–∞—Ç–∞–ª–æ–≥—É –∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Ä–µ–∂–∏–º –¥–æ—Å—Ç—É–ø–∞ –∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞: `cd /sambachmod -R 0755 public`
- –°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –≤—ã–±–µ—Ä–µ—Ç–µ –∫–∞—Ç–∞–ª–æ–≥, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –±—É–¥—É—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: `mkdir /samba/private`
- –°–æ–∑–¥–∞–π—Ç–µ –≥—Ä—É–ø–ø—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –¥–∞–Ω–Ω—ã–º: `groupadd smbgr`p
- –°–æ–∑–¥–∞–π—Ç–µ –Ω—É–∂–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã _useradd_: `useradd user1`
- –î–æ–±–∞–≤—å—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø—É: `usermod -aG smbgrp user1`
- –ò–∑–º–µ–Ω–∏—Ç–µ –≥—Ä—É–ø–ø—É, –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø—Ä–∏–≤–∞—Ç–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: `chgrp smbgrp /samba/private`
- –ó–∞–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å, —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –∫–∞—Ç–∞–ª–æ–≥—É: `smbpasswd -a user1`
- –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä nano: `nano /etc/samba/smb.conf`
- –ó–∞–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:

```
[global]
workgroup = WORKGROUP
security = user
map to guest = bad user
wins support = no
dns proxy = no

[public]
path = /samba/public
guest ok = yes
force user = nobody
browsable = yes
writable = yes

[private]
path = /samba/private
valid users = @smbgrp
guest ok = no
browsable = yes
writable = yes

```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –Ω–∞–∂–∞–≤ CTRL+X, –∑–∞—Ç–µ–º Enter –∏ Y.**

–ó–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤—ã—à–µ:

- global - —Ä–∞–∑–¥–µ–ª —Å –æ–±—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è Samba —Å–µ—Ä–≤–µ—Ä–∞
- workgroup - —Ä–∞–±–æ—á–∞—è –≥—Ä—É–ø–ø–∞ Windows, WORKGROUP - –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –≤—Å–µ—Ö Windows –º–∞—à–∏–Ω, –µ—Å–ª–∏ –≤—ã –Ω–µ –º–µ–Ω—è–ª–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ
- security - —Ä–µ–∂–∏–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∑–Ω–∞—á–µ–Ω–∏–µ user –æ–∑–Ω–∞—á–∞–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ –ª–æ–≥–∏–Ω—É –∏ –ø–∞—Ä–æ–ª—é
- map to guest - –∑–∞–¥–∞–µ—Ç —Å–ø–æ—Å–æ–± –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, bad user - –∑–∞–ø—Ä–æ—Å—ã —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º –±—É–¥—É—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω—ã, –µ—Å–ª–∏ —Ç–∞–∫–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- wins support - –≤–∫–ª—é—á–∏—Ç—å –∏–ª–∏ –≤—ã–∫–ª—é—á–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É WINS
- dns proxy - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ DNS
- public - –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—â–µ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥—É—Ç –≤–∏–¥–µ—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–µ—Ç–∏, –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º –∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –∏–º–µ–Ω–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- path - –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –¥–æ –æ–±—â–µ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞
- browsable - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞ –≤ —Å–µ—Ç–µ–≤–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- writable - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞ –Ω–∞ –∑–∞–ø–∏—Å—å, –∏–Ω–≤–µ—Ä—Å–∏—è read only
- guest ok - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –±–µ–∑ –ø–∞—Ä–æ–ª—è
- force user - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- valid users - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–∞—Ç–∞–ª–æ–≥—É, —á–µ—Ä–µ–∑ @ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è unix-–≥—Ä—É–ø–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ smb.conf –º–æ–∂–Ω–æ —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã:
- testparm -s

**–ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å—Ç—É–ø–∏–ª–∏ –≤ —Å–∏–ª—É, –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:**

`service smbd restart`

### 2. –î–∞–ª–µ–µ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å firewall iptables, –æ—Ç–∫—Ä—ã–≤ –ø–æ—Ä—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SAMBA. –ù–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ IP-–∞–¥—Ä–µ—Å–æ–≤ –∏–ª–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–Ω–æ–π —Å–µ—Ç–∏.

```
iptables ______________________ 445 ______________________–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ
iptables ______________________ 139 ______________________ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ
iptables ______________________ 137 ______________________ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ
iptables ______________________ 138 ______________________ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ

```

_–¢–µ–ø–µ—Ä—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤—ã—à–µ –ø—Ä–∞–≤–∏–ª–∞ —Ñ–∞–µ—Ä–≤–æ–ª–∞ iptables –±—ã–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –º–∞—à–∏–Ω—ã. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç –¥–ª—è iptables, –Ω–∏ —Å–∫—Ä–∏–ø—Ç, –Ω–∏ –∑–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç. –ï—Å—Ç—å –ø–∞–∫–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç —à—Ç–∞—Ç–Ω–æ._

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ iptables –º–æ–∂–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π:**

`iptables -L`

_–í –≤—ã–≤–æ–¥–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —Ä–∞–Ω–µ–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–∞—é—â–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ (Accept)._