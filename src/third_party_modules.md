# Сторонние модули



## numpy
Библиотека предоставляет множество инструментов для работы с математическими вычислениями. numpy поддерживает следующие математические операции:
- Арифметичекие операции с массивами;
- Универсальные функции, например, определение квадратного корня для каждого элемента массива;
- Линейная алгебра, например, вычисление матричного произведения, нахождение обратной матрицы и определителя;
- Вычисление статических параметров, например, среднее значение, стандартное отклонение и медиана;


```python
import numpy


# Создание одномерного массива
a = numpy.array([1,2,3])
# Создание двумерного массива
a2 = numpy.array([[1,2,3], [4,5,6]])
# Сложение массивов
res_a = a + a2
# Умножение массивов
res_m = a * a2
# Сравнение элементов массивов
res = a != a2
# Квадратный корень для каждого элемента массива
res = numpy.sqrt(a)
# Среднее значение массива
res = numpy.mean(a)
# Стандартное отклонение
res = numpy.std(a)
# Медиана
res = numpy.median(a)
```


## pandas

- Содержит двумерную табличную структуру данных (DataFrame) с метками по осям (столбцы и строки), которая может быть создана из различных источников данных, например, списки, словари, массивы numpy, CSV-файлы;
- DataFrame представляет из себя таблицу с данными, где каждая строка представляет собой отдельную запись, а каждый столбец - различные атрибуты этих записей;
- В DataFrame метки по осям позволяют легко идентифицировать данные;
- Предоставляет обширный набор методов и функций для фильтрации, сортировки, группировки, объединения и агрегации в DataFrame;
- Предоставляет встроенные средства для визуализации данных.

```python
data = {'Names': ['John', 'Timoti'], 'Age': [10, 20], 'City': ['NY', 'BR']}
d = pandas.DataFrame(data)
print(d)
# 0    John   10   NY
# 1  Timoti   20   BR

# Создание датафрейма из CSV-файла
d = pandas.read_csv('file.csv')

d.head(1)  # Вывод первой строки
d.tail(1)  # Вывод последней строки
d['Age']  # Выбор столбца по имени
d.loc[0]  # Выбор строки по индексу
d[d['Age'] > 15]  # Фильтрация по условию
d['Male'] = ['male', 'female']  # Добавление нового столбца
d.groupby('City')['Age'].mean()  # Группировка данных по столбцу 'City' и вычисление среднего значения возраста в каждой группе
d.sort_values(by='Age', ascending=False)  # Сортировка данных по убыванию по столбцу
d.groupby('City').agg({'Age': 'mean', 'Cash': 'sum'})  # Использование агрегации для расчета среднего возраста и суммы зарплаты для каждого города.
```


## matplotlib

Библиотека для визуализации данных в виде графиков и диаграмм. Поддерживает множество видов графиков, начиная от базовых линейных графиков и заканчивая сложными трехмерными графиками.

- Графики могут быть сохранены в форматах PNG, SVG, PDF и других.

Виды графиков:
- __Линейный график__: Отображает изменение значения переменной в зависимости от другой переменной во времени. Подходит для отслеживания трендов и показывает, как изменяется значение с течением времени;
- __Гистограмма__: Отображает распределение данных. Подходит для оценки формы и характеристик распределения, таких как центральная тенденция и разброс;
- __Круговая диаграмма__: Отображает долю каждой категории относительно общего значения. Подходит для процентного соотношения различных категорий в целом;
- __Диаграмма разброса__: Отображает связь между двумя переменными. Подходит для выявления корреляции и выявления возможных выбросов в данных;
- __Столбчатая диаграмма__: Отображает различия между категориями. Подходит для сравнения значений различных категорий;
- __Диаграмма "ящик с усами"__: Отображает распределение данных. Подходит для оценки статистических характеристик данных и сравнения распределений в различных группах;
- __Тепловая карта__: Отображает данные в виде цветового спектра. Подходит для выявления паттернов в матричных данных.

Методы:
- `plt.style.use()`: Задать тему оформления;


#### Пример 1

```python
import matplotlib.pyplot as plt
import numpy as np

# Линейный график
x = [1,2,3,4,5]
y = [1, 14, 7, 17, 9]
plt.plot(x, y, marker='o', linestyle='-', color='b')
plt.xlabel('X')
plt.ylabel('Y')
plt.title('Title')
plt.legend()

# Гистограмма
data = np.random.randn(1000)
plt.hist(data, bins=30, color='skyblue', edgecolor='black')
plt.xlabel('Значение')
plt.ylabel('Частота')
plt.title('Заголовок')

# Круговая диаграмма
sizes = [2, 7, 12, 16]
labels = ['label 1', 'label 2', 'label 3', 'label 4']
plt.pie(sizes, labels=labels, autopct='%1.1f%%', startangle=90, colors=['skyblue', 'lightcoral', 'lightgreen', 'lightpink'])
plt.title('Title')

# Диаграмма разброса
x = np.random.randn(100)
y = 2 * x + np.random.randn(100)
plt.scatter(x, y, color='green', alpha=0.7)
plt.xlabel('X')
plt.ylabel('Y')
plt.title('Title')

# Столбчатая диаграмма
categories = ['cat 1', 'cat 2', 'cat 3', 'cat 4']
values = [1, 2, 3, 4]
plt.bar(categories, values, color=['blue', 'orange', 'green', 'red'])
plt.xlabel('Categories')
plt.ylabel('Values')
plt.title('Title')

# Ящик с усами
data = np.random.randn(100, 3)
plt.boxplot(data, labels=['group 1', 'group 2', 'group 3'])
plt.xlabel('Groups')
plt.ylabel('Values')
plt.title('Title')

# Тепловая карта
data = np.random.rand(10, 10)
plt.imshow(data, cmap='viridis', interpolation='nearest')
plt.colorbar()
plt.title('Title')

plt.show()
```


#### Пример 2

В этом примере создан объект фигуры и осей с использованием subplots(), построен линейный график синусоиды с помощью plot(), настроены оси и добавлены подписи и заголовок.
```python
x = np.linspace(0, 10, 100)
y = np.sin(x)
# Создание объекта фигуры и осей
fig, ax = plt.subplots()
# Построение линейного графика
line, = ax.plot(x, y, label='sin')

# Настройка внешнего вида графика
line.set_color('red')
line.set_linestyle('-')
line.set_linewidth(1)

# Настройка осей
ax.set_xlabel('X')
ax.set_ylabel('Y')
ax.set_title('Title')
```


#### Пример 3

В этом примере создан линейный график, гистограмма и диаграмма на одной фигуре. Созданы данные для линейного графика y_lin, квадратичной зависимости y_qua. Создан объект фигуры и массив осей 2х2 с использованием subplots(). Построен линейный график, гистограмма и диаграмма разброса на соответствующих осях. Отрегулировано расположение графикоы с помощью tight_layout().
```python
# Создание данных
x = np.linspace(0, 10, 50)
y_lin = x + np.random.normal(0, 1, size=len(x))
y_qua = x ** 2 + np.random.normal(0, 2, size=len(x))

# Создание объекта фигуры и осей
fig, axes = plt.subplots(nrows=2, ncols=2, figsize=(10, 8))

# Создание линейного графика
axes[0, 0].plot(x, y_lin, color='blue', label='Linear')
axes[0, 0].set_title('Linear title')

# Создание гистограммы
axes[0, 1].hist(y_qua, bins=20, color='green', edgecolor='black')
axes[0, 1].set_title('Gisto')
axes[0, 1].set_xlabel('Values')

# Создание диаграммы разброса
axes[1, 0].scatter(x, y_qua, color='red', marker='o', alpha=0.8)
axes[1, 0].set_title('Scatter')
axes[1, 0].set_xlabel('X')
axes[1, 0].set_ylabel('Y')

# Удаление пустого графика
axes[1, 1].axis('off')

# Регулировка расположения графиков
plt.tight_layout()
```


#### Пример 4

В этом примере интегрируются numpy и pandas для создания графиков.
```python
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

# Пример данных numpy
np.random.seed(42)
data = np.random.randint(0, 10, size=(10, 2))

# Создание объекта фигуры и осей
fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(10, 4))

# Создание графика с использованием numpy
axes[0].scatter(data[:, 0], data[:, 1], color='blue')

# Пример данных с использованием pandas
data = pd.DataFrame(data, columns=['X', 'Y'])

# Создание графика с использованием pandas
data.plot(kind='bar', x='X', y='Y', color='green', ax=axes[1])

plt.tight_layout()

plt.show()
```


#### Пример 5

Поддержка различных форматов вывода.
```python
x = np.linspace(0, 2 * np.pi, 100)
y = np.sin(x)

plt.plot(x, y)
plt.savefig('sinus.png', format='png')
```


#### Пример 6

В этом примере создается гистограмма температуры по регионам.
```python
lat = np.random.uniform(low=-90, high=90, size=100)
lon = np.random.uniform(low=-180, high=180, size=100)
tem = np.random.uniform(low=-20, high=40, size=100)

fig, ax = plt.subplots(figsize=(12, 6))
scatter = ax.scatter(lon, lat, c=tem, cmap='rainbow_r', s=50, alpha=0.7)

plt.colorbar(scatter)
```


## SciPy

Библиотека для выполнения научных и инженерных расчетов.
- В машинном обучении и статистики используется для настройки параметров моделей, максимизации правдоподобия или минимизации функций потерь. Используется при обучении моделей (линейная регрессия, метод опорных векторов, нейронные сети);
- В инженерии методы оптимизации применяются при решении задач проектирования, оптимизации параметров систем и управления, а также минимизации энергопотребления в различных технических приложениях;
- В физических науках и химии методы оптимизации используются для нахождения минимумов энергии в молекулярных системах, моделирования структур и оптимизации параметров физических моделей;
- В экономике и финансах оптимизация применяется для портфельного  управления, оптимизации стратегий торговли и прогнозирования экономических показателей.


## TensorFlow

- Обучение модели в машинном обучении – это процесс настройки параметров модели так, чтобы она могла делать точные предсказания на основе предоставленных данных.
- Прежде чем начать обучение, необходимо подготовить данные. Обычно данные разделяются на тренировочные и тестовые наборы. Тренировочные данные используются для обучения модели, в то время как тестовые данные служат для оценки её производительности на ранее не виденных данных.


## Keras

- Является частью библиотеки TensorFlow, начиная с версии 2.0, что улучшает интеграцию и совместимость между двумя библиотеками;
- Высокоуровневая библиотека машинного обучения, разработанная для обеспечения простоты использования и интуитивного интерфейса для построения и обучения моделей;
- Предоставляет простой интерфейс для создания моделей, способных решать задачи классификации и регрессии. Это может включать в себя распознавание изображений, текстов, а также прогнозирование числовых значений;
- Создание рекуррентных нейронных сетей (RNN) и моделей на основе внимания, обеспечивающих эффективные решения задач NLP, таких как машинный перевод и анализ тональности;
- Создание сверточных нейронных сетей (CNN), применяемых для распознавания объектов, сегментации изображений и других задач компьютерного зрения;
- Создание генеративных моделей, таких как вариационные автокодировщики (VAE) и генеративные состязательные сети (GAN), которые могут использоваться для генерации новых данных, изображений, текстов и т.д;
- Легкая реализация передачи обучения, что позволяет использовать предварительно обученные модели, такие как модели из библиотеки TensorFlow Hub, для решения новых задач без необходимости обучения модели с нуля.


## Scikit-learn

- Включает широкий выбор алгоритмов машинного обучения – от методов опорных векторов до градиентного бустинга, инструменты для предобработки данных, оценку производительности моделей, кросс-валидацию, подбор оптимальных параметров и интеграцию с другими популярными библиотеками Python, такими как NumPy, Pandas и Matplotlib;
- Поддерживает разнообразные задачи машинного обучения, включая классификацию, регрессию, кластеризацию и другие;
- Предоставляет обширные инструменты для предобработки данных, включая методы шкалирования, кодирования категориальных переменных и выделения признаков.


## requests

- Используется при создании веб-скраперов, веб-приложений или при интеграции с внешними API;
- Простой и удобный интерфейс для отправки HTTP-запросов на серверы, получения ответов и работы с данными;
- Легкость в использовании для отправки запросов различных типов (GET, POST, PUT, DELETE и др.);
- Возможность передавать параметры запроса в удобной форме;
- Возможность установки заголовков запроса и создания сессий для управления состоянием.


## Beautiful Soup

- Обработка HTML и XML документов, создавая структурированное дерево элементов;
- Обход дерева документа с помощью различных методов, таких как `find`, `find_all`, `select`;
- Извлечение текста, атрибутов, ссылок и других данных из элементов.


## Lxml

- Используется вместе с Beautiful Soup для парсинга и обработки данных;
- Эффективные методы для парсинга XML и HTML и построения дерева элементов;
- XPath для выбора элементов в документе;
- Добавления, изменения и удаления элементов в документе;


## SQLite3

- Предоставляет методы для выполнения SQL-запросов, вставки, обновления и удаления данных;
- Используется для небольших проектов, тестирования и прототипирования.

```python
import sqlite3

# Подключение к БД
conn = sqlite3.connect('base.db')

# Создание курсора
cursor = conn.cursor()

# Выполнение SQL-запроса
cursor.execute('CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY, name TEXT)')

# Вставка данных
cursor.execute('INSERT INTO users (name) VALUES (?)', ('Baby'))

# Получение данных
cursor.execute('SELECT * FROM users')
data = cursor.fetchall()

# Закрыть соединение
conn.close()
```


## MySQL

```python
import mysql.connector


# Подключение к базе данных
conn = mysql.connector.connect(
    host='localhost',
    user='user',
    password='password',
    database='example'
)

# Создание курсора
cursor = conn.cursor()

# Выполнение SQL-запроса
cursor.execute('CREATE TABLE IF NOT EXISTS users (id INT
AUTO_INCREMENT PRIMARY KEY, name VARCHAR(255), age INT)')

# Вставка данных
cursor.execute('INSERT INTO users (name, age) VALUES (%s, %s)',
('John Doe', 25))

# Получение данных
cursor.execute('SELECT * FROM users')
data = cursor.fetchall()

# Закрытие соединения
conn.close()
```