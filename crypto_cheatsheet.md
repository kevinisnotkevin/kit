# Криптография


- Алгоритмы шифрования нужны для сохранения конфиденциальности данных. 
- Зашифрованное сообщение можно расшифровать, если известен алгоритм и есть ключ. 
- Алгоритмы шифрования разделяют на симметричные и ассиметричные.


## Симметричное шифрование
- Есть секретный ключ, с помощью которого осуществляется шифрование.
- Секретный ключ передается по защищенному каналу передачи ключа.
- Отправитель передает зашифрованное сообщение по незащищенному каналу передачи информации.
- Получатель с помощью того же секретного ключа расшифровывает полученное зашифрованное сообщение.
- Преимущества симметричного шифрования:
    - Высокая скорость работы.
    - Простота реализации.
- Недостатки симметричного шифрования:
    - Необходим защищенный канал для распределения секретных ключей.
    - Необходимо большое количество ключей (для n пользователей нужно n(n-1)/2 ключей).

__Симметричный алгоритм шифрования__ – алгоритм, который использует один и тот же ключ для шифрования и дешифрования. Примеры включают расширенный стандарт шифрования (AES) и алгоритм тройного шифрования данных (3DES). Основная проблема в симметричном шифровании – безопасное разделение ключа между участвующими сторонами. 

Симметричные алгоритмы шифрования:
- ГОСТ 28147-89 – стандартный российский образец;
- DES (Data Encryption Standard) – Сообщение бьется на блоки, блоки перестанавливаются и многократно шифруются с помощью ключа, далее происходит конечная перестановка. Режимы работы DES:
    - ECB (Electronic Code Book) – Шифрование ключей;
    - CBC (Cipher Block Chaining) – Аутентификация;
    - CFB (Cipher Feed Back) – Шифрование отдельных символов, аутентификация;
    - OFB (Output Feed Back) – Шифрование спутниковых систем связи;
- 3DES (Triple-DES) – Алгоритм DES, который использует два дополнительных ключа;
- RC4 – потоковый симметричный алгоритм, основанный на использоваии гаммы, операции XOR и генераторе псевдослучайных чисел. Ключ от 8 до 2048 бит;
- RC6 – шифр Ривеста;
- SEED – шифровальный алгоритм корейского происхождения;
- XTEA – самый простой алгоритм шифрования:
- AES:
    - Имеет большую длину ключа (128, 192, 256 бит).
    - Разбивает блоки данных на массивы размером 4х4, 4х6, 4х8 в зависимости от длины блока;
    - Состоит из определенного количества раундов (10, 12, 14) - в завимисимости от размера блока и ключа;
    - Выполняет 4 преобразования.


## Ассиметричное шифрование
__Ассиметричный алгоритм шифрования__ – алгоритм, который использует два разных ключа – закрытый ключ и открытый ключ. Закрытый ключ хранится в секрете, а открытый ключ доступен. Открытый ключ используется для шифрования сообщения, закрытый – для дешифрования. Примеры алгоритмов асимметричного шифрования включают RSA и криптографию на основе эллиптических кривых (ECC). Эти два ключа между собой взаимосвязаны алгоритмом. Можно использовать открытый канал связи для передачи сообщений. Сложная для понимания система. Большие ресурсы для дешифровки. Примеры асимметричных алгоритмов шифрования:
- RSA – Rivest-Shamir-Adleman;
- DSA – Digital Signature Algorithm;
- Elgamal – шифрсистема Эль-Гамаля;
- Diffie-Hellman – обмен ключами Диффи-Хелмана;
- ECC – Elliptic Curve Cryptography;
- ГОСТ Р 34.10-2001.


## Hashing
__Хеширование__ – математический алгоритм, который преобразовывает данные в строку фиксированной длины. В строке могут быть буквы и цифры, но длина всегда одна, вне зависимости от вводных данных. Хеширование используется для хранения паролей, защиты медиафайлов от пиратства, поиска вирусов по спискам хешов зловредов, защиты от фальсификации данных. Характеристики хорошей хеш-функции: детерминированность, эффективность, лавинный эффект, односторонняя функция, устойчивость к коллизиям.

__Хеш-функция__ - функция, осуществляющая преобразование массива входных данных произвольной длины в выходную битовую строку установленной длины, выполняемая определенным алгоритмом. Преобразование называется хешированием. Исходные данные называются входным массивом или ключом или сообщением. Выходные данные называются хеш или хеш-код или хеш-сумма или сводка сообщений.

__Энтропия__ - мера неопределенности некоторой системы, непредсказуемость появления какого-либо символа первичного алфавита.

### Алгоритмы хеширования
__MD5 (Message Digest 5)__ – преобразует входные данные произвольной длины в 128-битное хеш-значение.
- Быстрое и простое хеширование данных
- Небезопасен для криптографических задач, так как существуют атаки, которые позволяют создавать коллизии в хеш-функции
- Может использоваться для проверки целостности данных и обнаружения подмены данных
- Не рекомендуют для критических систем: электронных подписей, паролей
- Поддержка в различных ОС и языках программирования
	
__SHA-1 (Secure Hash Algoritm)__ – преобразует произвольные данные переменной длины в хеш-значение с фиксированной длиной 160 бит.
- Надежное хеширование данных, используют для проверки целостности
- Небезопасен для криптографических задач, так как существуют атаки, которые позволяют создавать коллизии в хеш-функции
- Быстрый и простой в использовании
- Не рекомендуют для критических систем: электронных подписей, паролей. SHA-1 надежнее MD5, но недостаточно безопасен
- Используется в некоторых стандартах и протоколах, например, в SSL и TLS.
- Объявлен небезопасным, поэтому многие организации переходят на более современные и безопасные алгоритмы хеширования

__SHA-2__ – набор алгоритмов хеширования данных, безопасен для применения в криптографических целях. В него входят хеш-функции с разными размерами выходных значений: SHA-224, SHA-256, SHA-384, SHA-512. Цифры – количество бит. Чем больше размер выходного хеша, тем выше стойкость к атакам и выше требования к мощности.
- Высокая стойкость к коллизиям, считается одним из наиболее безопасных алгоритмов
- Медленнее некоторых других алгоритмов. Особенно заметно при больших выходных значениях
- Разные размеры выходных значений, поэтому можно выбрать вариант в зависимости от задачи
- Есть атаки, которые создают коллизии, но они требуют огромные мощности
- Поддержка многими ОС и языками программирования
- Применяют для защиты данных, электронных подписей, проверки целостности и подлинности данных, хранения паролей

__SHA-3__ – использует хеш-значения разной длины, но отличается более высоким уровнем безопасности.
- Устойчив к атакам
- Относительно новый алгоритм: его еще не все приняли
- Высокая производительность на современных процессорах
- Сложен для эксплуатации по сравнению с прошлыми алгоритмами
- Генерирует хеш-значения в зависимости от задачи
- Довольно медленный: уступает SHA-256
- Для высокой скорости хеширования нужно специальное оборудование

__BLAKE__ – используется хеш-значения разной длины. Отличается высокой скоростью и безопасностью. Используется для защиты данных, проверки целостности данных и электронных подписей.
- Высокая скорость
- Используется меньше, чем SHA-1 и MD5. Недостаточно изучен
- Высокая стойкость к атакам
- Старые приложения не поддерживают BLAKE, поэтому могут быть проблемы при обмене данными между разными приложениями
- Открытый исходный код

__bcrypt__ – адаптичная криптографическая хеш-фукнция формирования ключа, используемая для защищенного хранения паролей. Для защиты от атак с помощью радужных таблиц использует соль. Является адаптивной, время работы легко настраивается и ее можно замедлить, чтобы усложнить атаку перебором.

__scrypt__ – адаптивная криптографическая функция формирования ключа на основе пароля. Усложняет атаку перебором.

__argon2__ – функция формирования ключа.

__PDKDF2__ – стандарт формирования ключа на основе пароля. Функция до scrypt, вычисляющая быстро.



## Salting
__Salting__ – метод, используемый для повышения безопасности паролей или эквивалентных данных путем добавления дополнительного уровня защиты для их защиты от попыток взлома.
__Salt__ – случайная строка данных, которая генерируется и объединяется с паролем пользователя перед хешированием с целью сделать хешированный вывод данных уникальным, даже если два пользователя используют один и тот же пароль.
> Принцип работы: Когда пользователь создает или обновляет свой пароль, генерируется соль с использованием криптографически безопасного генератора случайных чисел. Сгенерированная соль объединяется с паролем пользователя посредством конкатенации или другого аналогичного метода. Обновленный пароль хешируется с использованием алгоритма хеширования, создавая уникальный результат хеширования. И соль, и хешированный пароль хранятся в БД вместе с информацией об учетной записи пользователя для проверки пароля во время будущих попыток аутентификации.


## Obfuscation
__Obfuscation__ – практика усложнения понимания или поиска чего-либо путем изменения или сокрытия содержания или внешнего вида. В криптографии обфускация – процесс, при котором данные, код или связь становятся менее читаемыми и их сложнее интерпретировать или реконструировать. Обфускация повышает безопасность за счет сокрытия информации от несанкционированного доступа, защиты интеллектуальной собственности, предотвращения или затруднения обратного проектирования, подделки или анализа кода или структур данных.
Методы обфускации: Переименование названий, изменение потока управления, кодирование данных, шифрование кода.


## Key Exchange
__Key Exchange__ – процесс, в котором две стороны создают общий секретный ключ, который можно использовать для шифрования и дешифрования сообщений между ними. Ключ обеспечивает безопасную связь, предотвращая подслушивание и вмешательство третьих лиц. 

__Public key__ – общедоступный криптографический ключ, соединенный с закрытым ключом. Любой может использовать ключ для шифрования данных или проверки подписей, но только закрытый ключ может расшифровать данные или создать подписи. Открытый ключ может распространяться свободно.
__Private key__ – конфиденциальный криптографический ключ, который однозначно связан с отдельным лицом или организацией. Он должен храниться в тайне. Используется для расшифровки данных, зашифрованных с помощью открытого ключа или для подписи цифровых документов. Потеря закрытого ключа может привести к утечке данных и компрометации информации.

### Diffie-Hellman Key Exchange
__Диффи-Хеллман (DH)__ – криптографический протокол, который позволяет двум сторонам согласовать общий секретный ключ без предварительного знания друг друга. Обмен ключами происходит по общедоступному каналу и основан на математических свойствах модульной арифметики и возведения в степень. Безопасность DH зависит от сложности задачи дискретного логарифма (DLP). DH подвержен MiTM, где хакер может перехватить обмен ключами и предоставить свои публичные ключи.
Описание работы: Обе стороны договариваются о большом простом числе p и общем g, которые общеизвестны и могут использоваться всеми пользователями системы. Каждая сторона генерирует приватный секретный ключ a и b, которые должны оставаться конфиденциальными. Стороны вычисляют публичные значения: A=g^a mod p и B=g^b mod p. Значения передаются по общедоступному каналу. Общий секретный ключ рассчитывается с использованием общедоступных значений: s=B^a mod p и s=A^b mod p. Оба вычисления приводят к одному и тому же значению s, которое можно использовать в качестве общего ключа для симметричного шифрования.

### Elliptic Curve Diffie-Hellman (ECDH)
__Elliptic Curve Diffie-Hellman__ – вариант протокола DH, в котором вместо модульной арифметики используется криптография на основе эллиптических кривых. ECDH обеспечивает безопасность, аналогичную DH, но с более короткими ключами, что приводит к более быстрым вычислениям и снижению потребления ресурсов.
Описание работы: Обе стороны договариваются об эллиптической кривой и общей точке G на кривой. Каждая сторона генерирует закрытый секретный ключ a и b. Они вычисляют общедоступные значения: A=aG и B=bG, которые передаются по общедоступному каналу. Общий секретный ключ рассчитывается с использованием общедоступных значений: s=aB и s=bA. В результате этих вычислений получается одна и та же точка s, которую можно использовать в качестве общего ключа для симметричного шифрования.

### Public-Key Infrastructure and Key Exchange
__PKI__ – система, используемая для управления распространением и идентификацией открытых ключей шифрования, которая обеспечивает основу для создания, хранения и распространения цифровых сертификатов, позволяя пользователям безопасно обмениваться данными с помощью пары открытых и частных криптографических ключей, предоставляемых центром сертификации (CA). Сертификаты используются для аутентификации открытых ключей и их владения, помогая смягчить MiTM атаки. Во время обмена ключами стороны обмениваются сертификатами для проверки открытых ключей друг друга. За этим процессом следует безопасный протокол обмена ключами DH или ECDH, для создания общего секретного ключа для симметричного шифрования. Используется в безопасном общении по email, безопасной передаче файлов, безопасном удаленном доступе и VPN, безопасности HTTPS, цифровых подписях, безопасности IoT.
__Центр сертификации (CA)__ – доверенная сторонняя организация, которая выдает цифровые сертификаты и управляет ими. CA проверяет идентичность объектов и выдает цифровые сертификаты, подтверждающие эту идентичность.
__Центр регистрации (RA)__ – подчиненный орган, который помогает CA проверять идентичность перед выдачей цифровых сертификатов. RA также помогает участвовать в отзыве сертификатов или управлении восстановлением ключей.
__Цифровые сертификаты__ – электронные документы, содержащие открытый ключ и другую идентифицирующую информацию об объекте, а также цифровую подпись CA.
__Открытый и частный ключ__ – уникальные криптографические ключи, генерируемые вместе, при этом открытый ключ используется совместно с другими, а закрытый ключ хранится владельцем в секрете. Открытый ключ шифрует данные, а закрытый ключ расшифровывает их.
